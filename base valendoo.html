<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ficha Cadastral</title>
    <style>
        /* Seu CSS completo, inalterado */
        .tooltip-container {
            position: relative;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        .tooltip-icon {
            font-weight: bold;
            color: #007BFF;
            cursor: pointer;
            border: 1px solid #007BFF;
            border-radius: 50%;
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-style: normal;
            font-size: 10px;
        }
        .tooltip-text {
            visibility: hidden;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -75px;
            opacity: 0;
            transition: opacity 0.3s;
            width: 150px;
            font-weight: normal;
            font-size: 10px;
        }
        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #555 transparent transparent transparent;
        }
        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }
        body {
            font-family: Arial, sans-serif;
            font-size: 11px;
            width: 800px;
            margin: 20px auto;
            border: 1px solid #ccc;
            padding: 20px;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .header-logo {
            width: 100px;
            height: 50px;
            border: 1px dashed #ccc;
            text-align: center;
            line-height: 50px;
            font-size: 10px;
        }
        .header-title {
            text-align: center;
            flex-grow: 1;
        }
        .header-title h1 {
            font-size: 16px;
            margin: 0;
        }
        .header-date {
            width: 150px;
            font-size: 10px;
        }
        .form-section {
            border: 1px solid #000;
            margin-bottom: 15px;
            padding: 5px;
        }
        .section-title {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .field-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 5px;
        }
        .field-item {
            display: flex;
            flex-direction: column;
            flex: 1;
            min-width: 150px;
        }
        .field-small {
            flex: 0 0 50px;
            min-width: 50px;
        }
        .field-item label {
            font-weight: bold;
            margin-bottom: 3px;
        }
        .field-item input[type="text"],
        .field-item input[type="number"],
        .field-item input[type="date"],
        .field-item select,
        .field-item textarea {
            border: none;
            border-bottom: 1px solid #000;
            padding: 2px;
            font-size: 11px;
            width: 100%;
            box-sizing: border-box;
        }
        .checkbox-container {
            display: flex;
            align-items: center;
            margin-top: 10px;
        }
        .checkbox-container input {
            margin-right: 5px;
        }
        .checkbox-container label {
            font-weight: normal;
        }
        .field-row {
            display: flex;
            gap: 10px;
            margin-bottom: 5px;
        }
        .field-row .field-item {
            flex: 1;
        }
        .field-row-full {
            flex: 1;
        }
        .full-width {
            width: 100%;
        }
        .hidden {
            display: none;
        }
        .legal-text {
            font-size: 9px;
            text-align: justify;
            margin-top: 10px;
            line-height: 1.5;
        }
        .signature-line {
            display: inline-block;
            width: 100%;
            border-bottom: 1px solid #000;
            margin-top: 50px;
        }
        .signature-text {
            text-align: center;
            font-size: 10px;
            margin-top: 5px;
        }
        .add-button, .kml-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 5px 10px;
            font-size: 10px;
            cursor: pointer;
            border-radius: 3px;
            margin-left: 10px;
        }
        .remove-button {
            background-color: #d9534f;
            color: white;
            border: none;
            padding: 5px 10px;
            font-size: 10px;
            cursor: pointer;
            border-radius: 3px;
            margin-left: 10px;
        }
        .kml-area-display {
            font-size: 10px;
            margin-top: 5px;
            color: #555;
            padding-left: 10px;
        }
        .save-button {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }
        .save-button:hover {
            background-color: #0056b3;
        }
        .tabs {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            border-bottom: 2px solid #ccc;
            margin-bottom: 20px;
        }
        .tab-button {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-bottom: none;
            background-color: #f1f1f1;
            margin-bottom: -2px;
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
            transition: background-color 0.3s;
            font-size: 10px;
            font-weight: bold;
        }
        .tab-button:hover {
            background-color: #e2e2e2;
        }
        .tab-button.active {
            background-color: #fff;
            border-color: #000;
            border-bottom-color: #fff;
            color: #000;
        }
        .tab-content {
            display: none;
            padding: 15px;
            border: 1px solid #ccc;
            border-top: none;
        }
        .tab-content.active {
            display: block;
        }
        .text-center {
            text-align: center;
        }
        .legal-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        .legal-item input[type="checkbox"] {
            margin-right: 10px;
            margin-top: 5px;
        }
        .legal-item p {
            margin: 0;
            font-size: 10px;
        }
        /* Estilos para impressão / PDF */
        @media print {
            body {
                margin: 0;
                padding: 0;
                border: none;
            }
            .header, .tabs, .save-button {
                display: none !important;
            }
            .tab-content-container {
                border: none !important;
            }
            .tab-content {
                display: block !important;
                border: 1px solid #000;
                padding: 5px;
            }
            .form-section {
                border: none;
                margin-bottom: 10px;
                padding: 0;
                page-break-inside: avoid;
            }
            #form-content {
                width: 100%;
                margin: 0;
                padding: 10px;
            }
            .print-only {
                display: block !important;
            }
        }
        .print-only {
            display: none;
        }

        /* Novo estilo para a assinatura */
        .signature-block {
            margin-top: 80px; /* Aumenta o espaço para a assinatura */
            text-align: center;
        }
        .signature-block .line {
            width: 50%;
            margin: 0 auto;
            border-bottom: 1px solid #000;
        }
        .signature-block .info-text {
            font-size: 10px;
            margin-top: 5px;
        }
        .flex-row-signature {
            display: flex;
            justify-content: center;
            gap: 50px;
            margin-top: 20px;
        }
        .flex-row-signature .signature-item {
            text-align: center;
        }
    </style>
</head>
<body>
    <button class="save-button" onclick="generatePdf()">Salvar PDF</button>

    <div id="form-content">
        <div class="header">
            <div class="header-logo">LOGO</div>
            <div class="header-title">
                <h1>FICHA CADASTRO</h1>
            </div>
            <div class="header-date">
                Data do Cadastro<br>
                <input type="date" class="full-width" id="data-cadastro">
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" data-tab-target="#identificacao">Identificação</button>
            <button class="tab-button" data-tab-target="#info-pf">Informações P.F.</button>
            <button class="tab-button" data-tab-target="#endereco-pf">Endereço P.F.</button>
            <button class="tab-button" data-tab-target="#rendas">Rendas</button>
            <button class="tab-button" data-tab-target="#outras-receitas">Outras Receitas</button>
            <button class="tab-button" data-tab-target="#dados-financeiros">Dados Financeiros</button>
            <button class="tab-button" data-tab-target="#pecuaria">Pecuária</button>
            <button class="tab-button" data-tab-target="#bens-moveis">Bens Móveis</button>
            <button class="tab-button" data-tab-target="#bens-imoveis">Bens Imóveis</button>
            <button class="tab-button" data-tab-target="#funcionarios">Funcionários</button>
            <button class="tab-button" data-tab-target="#seguros">Seguros</button>
            <button class="tab-button" data-tab-target="#aceites">Aceites</button>
            <button class="tab-button" data-tab-target="#declaracao">Declaração</button>
        </div>
        
        <div class="tab-content-container">
            <div id="identificacao" class="tab-content active">
                <div class="form-section">
                    <div class="field-group">
                        <div class="field-item full-width">
                            <label>Código Cliente</label>
                            <input type="text">
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label class="tooltip-container">
                                Unidade 3T
                                <i class="tooltip-icon">i</i>
                                <span class="tooltip-text">Unidade com a qual o cliente tem relacionamento</span>
                            </label>
                            <select id="unidade-3t">
                                <option value="">Selecione</option>
                                <option value="Água Boa">Água Boa</option>
                                <option value="Ajuricaba">Ajuricaba</option>
                                <option value="Alegrete">Alegrete</option>
                                <option value="Alta Floresta">Alta Floresta</option>
                                <option value="Arroio Grande">Arroio Grande</option>
                                <option value="Augusto Pestana">Augusto Pestana</option>
                                <option value="Bagé">Bagé</option>
                                <option value="Boa Vista do Cadeado">Boa Vista do Cadeado</option>
                                <option value="Cachoeira do Sul">Cachoeira do Sul</option>
                                <option value="Camaquã">Camaquã</option>
                                <option value="Campo Novo">Campo Novo</option>
                                <option value="Canguçu">Canguçu</option>
                                <option value="Capão do Cipó">Capão do Cipó</option>
                                <option value="Capivari">Capivari</option>
                                <option value="Catuípe">Catuípe</option>
                                <option value="Colorado">Colorado</option>
                                <option value="Condor">Condor</option>
                                <option value="Confresa">Confresa</option>
                                <option value="Coronel Barros">Coronel Barros</option>
                                <option value="Cruz Alta">Cruz Alta</option>
                                <option value="Dom Pedrito">Dom Pedrito</option>
                                <option value="Entre-Ijuís">Entre-Ijuís</option>
                                <option value="Erechim">Erechim</option>
                                <option value="Espumoso">Espumoso</option>
                                <option value="Eugênio de Castro">Eugênio de Castro</option>
                                <option value="Fortaleza dos Valos">Fortaleza dos Valos</option>
                                <option value="Giruá">Giruá</option>
                                <option value="Horizontina">Horizontina</option>
                                <option value="Ibirubá">Ibirubá</option>
                                <option value="Ijuí">Ijuí</option>
                                <option value="Jóia">Jóia</option>
                                <option value="Lagoa Vermelha">Lagoa Vermelha</option>
                                <option value="Lucas do Rio Verde">Lucas do Rio Verde</option>
                                <option value="Matupá">Matupá</option>
                                <option value="Mauá">Mauá</option>
                                <option value="Nonoai">Nonoai</option>
                                <option value="Nova Mutum">Nova Mutum</option>
                                <option value="Nova Ubiratã">Nova Ubiratã</option>
                                <option value="Palmeira das Missões">Palmeira das Missões</option>
                                <option value="Panambi">Panambi</option>
                                <option value="Passo Fundo">Passo Fundo</option>
                                <option value="Pejuçara">Pejuçara</option>
                                <option value="Pelotas">Pelotas</option>
                                <option value="Porto dos Gaúchos">Porto dos Gaúchos</option>
                                <option value="Querência">Querência</option>
                                <option value="Rosário do Sul">Rosário do Sul</option>
                                <option value="Saldanha Marinho">Saldanha Marinho</option>
                                <option value="Santa Bárbara do Sul">Santa Bárbara do Sul</option>
                                <option value="Santa Cruz do Xingu">Santa Cruz do Xingu</option>
                                <option value="Santa Maria">Santa Maria</option>
                                <option value="Santa Vitória do Palmar">Santa Vitória do Palmar</option>
                                <option value="Santiago">Santiago</option>
                                <option value="Santo Augusto">Santo Augusto</option>
                                <option value="São Gabriel">São Gabriel</option>
                                <option value="São Luiz Gonzaga">São Luiz Gonzaga</option>
                                <option value="Sinop">Sinop</option>
                                <option value="Sorriso">Sorriso</option>
                                <option value="Três de Maio">Três de Maio</option>
                                <option value="Tupanciretã">Tupanciretã</option>
                                <option value="Vacaria">Vacaria</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Regional TC</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="Noroeste - Ijuí">Noroeste - Ijuí</option>
                                <option value="Noroeste - Missões">Noroeste - Missões</option>
                                <option value="Norte - Matriz">Norte - Matriz</option>
                                <option value="Norte - Passo Fundo">Norte - Passo Fundo</option>
                                <option value="Planalto">Planalto</option>
                                <option value="Pomelo">Pomelo</option>
                                <option value="Sudeste - Centro">Sudeste - Centro</option>
                                <option value="Sudeste - Litoral">Sudeste - Litoral</option>
                                <option value="Sul">Sul</option>
                                <option value="163 Norte - Alta Floresta - MT">163 Norte - Alta Floresta - MT</option>
                                <option value="163 Norte - Sinop - MT">163 Norte - Sinop - MT</option>
                                <option value="163 Sul - Lucas do Rio Verde - MT">163 Sul - Lucas do Rio Verde - MT</option>
                                <option value="163 Sul - Sorriso - MT">163 Sul - Sorriso - MT</option>
                                <option value="Araguaia Norte - MT">Araguaia Norte - MT</option>
                                <option value="Araguaia Sul - MT">Araguaia Sul - MT</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div id="info-pf" class="tab-content">
                <div class="form-section">
                    <div class="field-group">
                        <div class="field-item full-width">
                            <label>Nome</label>
                            <input type="text" id="nome-pf">
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>CPF</label>
                            <input type="text" id="cpf">
                        </div>
                        <div class="field-item">
                            <label>Data de Nasc.</label>
                            <input type="date">
                        </div>
                        <div class="field-item">
                            <label>Sexo</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="Masculino">Masculino</option>
                                <option value="Feminino">Feminino</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Nacionalidade</label>
                            <select>
                                <option value="Brasil">Brasil</option>
                                <option value="Estrangeiro">Estrangeiro</option>
                            </select>
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>Naturalidade</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>UF Naturalidade</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option><option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option><option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option><option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option><option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option><option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                            </select>
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>Tipo Documento</label>
                            <select>
                                <option value="RG">RG</option>
                                <option value="CNH">CNH</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Nº Documento</label>
                            <input type="number">
                        </div>
                        <div class="field-item">
                            <label>Órgão Emissor</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>Data Emissão</label>
                            <input type="date">
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>Grau de Instrução</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="fundamental_inc">Ensino Fundamental Incompleto</option>
                                <option value="fundamental_comp">Ensino Fundamental Completo</option>
                                <option value="medio_inc">Ensino Médio Incompleto</option>
                                <option value="medio_comp">Ensino Médio Completo</option>
                                <option value="superior_inc">Ensino Superior Incompleto</option>
                                <option value="superior_comp">Ensino Superior Completo</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Nº de Dependentes</label>
                            <select>
                                <option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Analfabeto?</label>
                            <select>
                                <option value="nao">Não</option>
                                <option value="sim">Sim</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Telefone</label>
                            <input type="text" id="telefone">
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>Celular</label>
                            <input type="text" id="celular">
                        </div>
                        <div class="field-item">
                            <label>Email</label>
                            <input type="text" id="email">
                        </div>
                        <div class="field-item">
                            <label>Nome Pai</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>Nome Mãe</label>
                            <input type="text">
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>Estado Civil</label>
                            <select id="estado-civil">
                                <option value="Solteiro">Solteiro</option>
                                <option value="Casado">Casado</option>
                                <option value="Divorciado">Divorciado</option>
                                <option value="Viúvo">Viúvo</option>
                            </select>
                        </div>
                        <div class="field-item hidden" id="regime-casamento-container">
                            <label>Regime de Casamento</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="Comunhão parcial de bens">Comunhão parcial de bens</option>
                                <option value="Comunhão universal de bens">Comunhão universal de bens</option>
                                <option value="Separação total de bens">Separação total de bens</option>
                                <option value="Participação final nos aquestos">Participação final nos aquestos</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>União Estável</label>
                            <select>
                                <option value="Não">Não</option>
                                <option value="Sim">Sim</option>
                            </select>
                        </div>
                    </div>
                    <div class="field-group hidden" id="conjuge-info-container">
                        <div class="field-item">
                            <label>Nome do Cônjuge</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>CPF do Cônjuge</label>
                            <input type="text" id="cpf-conjuge">
                        </div>
                        <div class="field-item">
                            <label>Sexo</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="Masculino">Masculino</option>
                                <option value="Feminino">Feminino</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Nacionalidade</label>
                            <select>
                                <option value="Brasil">Brasil</option>
                                <option value="Estrangeiro">Estrangeiro</option>
                            </select>
                        </div>
                    </div>
                    <div class="field-group hidden" id="conjuge-info-container-2">
                         <div class="field-item">
                            <label>Naturalidade</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>UF Naturalidade</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="AC">AC</option><option value="AL">AL</option><option value="AP">AP</option><option value="AM">AM</option><option value="BA">BA</option><option value="CE">CE</option><option value="DF">DF</option><option value="ES">ES</option><option value="GO">GO</option><option value="MA">MA</option><option value="MT">MT</option><option value="MS">MS</option><option value="MG">MG</option><option value="PA">PA</option><option value="PB">PB</option><option value="PR">PR</option><option value="PE">PE</option><option value="PI">PI</option><option value="RJ">RJ</option><option value="RN">RN</option><option value="RS">RS</option><option value="RO">RO</option><option value="RR">RR</option><option value="SC">SC</option><option value="SP">SP</option><option value="SE">SE</option><option value="TO">TO</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Tipo Documento</label>
                            <select>
                                <option value="RG">RG</option>
                                <option value="CNH">CNH</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Nº Documento</label>
                            <input type="number">
                        </div>
                    </div>
                    <div class="field-group hidden" id="conjuge-info-container-3">
                         <div class="field-item">
                            <label>Data Emissão</label>
                            <input type="date">
                        </div>
                        <div class="field-item">
                            <label>Órgão Emissor</label>
                            <input type="text">
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>Profissão</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>Valor remuneração</label>
                            <input type="text" class="valor-input" placeholder="0,00">
                        </div>
                        <div class="field-item">
                            <label>Insc. Estadual</label>
                            <input type="text">
                        </div>
                    </div>
                </div>
            </div>

            <div id="endereco-pf" class="tab-content">
                <div class="form-section">
                    <div class="field-group">
                        <div class="field-item" style="width: 150px;">
                            <label>CEP</label>
                            <input type="text" id="cep">
                        </div>
                        <div class="field-item" style="flex-grow: 2;">
                            <label>Endereço (Logradouro, Rua, Av.)</label>
                            <input type="text" id="logradouro">
                        </div>
                        <div class="field-item" style="width: 80px;">
                            <label>Nº</label>
                            <input type="number">
                        </div>
                    </div>
                    <div class="field-group">
                        <div class="field-item" style="flex-grow: 2;">
                            <label>Complemento</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>Bairro</label>
                            <input type="text" id="bairro">
                        </div>
                        <div class="field-item">
                            <label>Cidade</label>
                            <input type="text" id="cidade" readonly>
                        </div>
                        <div class="field-item" style="width: 80px;">
                            <label>UF</label>
                            <input type="text" id="uf" readonly>
                        </div>
                    </div>
                </div>
            </div>

            <div id="rendas" class="tab-content">
                <div class="form-section">
                    <div class="field-group">
                        <div class="field-item">
                            <label>Ano de Exercício do I.R.</label>
                            <input type="number">
                        </div>
                        <div class="field-item">
                            <label>Receita Bruta Agrícola</label>
                            <input type="text" class="valor-input" id="receita-agricola" placeholder="0,00">
                        </div>
                        <div class="field-item">
                            <label>Demais Receitas</label>
                            <input type="text" class="valor-input" id="demais-receitas" placeholder="0,00">
                        </div>
                        <div class="field-item">
                            <label>Total Rendas</label>
                            <input type="text" class="valor-input" id="total-rendas" placeholder="0,00" readonly>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Rendas da Última Safra</div>
                    <div id="renda-safra-container">
                        <div class="field-group renda-safra-item">
                            <div class="field-item">
                                <label>Ano safra</label>
                                <select>
                                    <option value="2024/2025">2024/2025</option>
                                    <option value="2025/2026">2025/2026</option>
                                </select>
                            </div>
                            <div class="field-item">
                                <label>Cultura</label>
                                <select>
                                    <option value="Soja">Soja</option>
                                    <option value="Milho">Milho</option>
                                    <option value="Trigo">Trigo</option>
                                    <option value="Canola">Canola</option>
                                    <option value="Sorgo">Sorgo</option>
                                    <option value="Outros">Outros</option>
                                </select>
                            </div>
                            <div class="field-item">
                                <label>Área plantada (ha)</label>
                                <input type="number" class="renda-area">
                            </div>
                            <div class="field-item">
                                <label>Produtividade (sc/ha)</label>
                                <input type="number" class="renda-produtividade">
                            </div>
                            <div class="field-item">
                                <label>Preço por saca (R$)</label>
                                <input type="text" class="valor-input renda-preco" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Valor da produção (R$)</label>
                                <input type="text" class="valor-input renda-valor-producao" placeholder="0,00" readonly>
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">Projeção da Próxima Safra</div>
                    <div id="projecao-safra-container">
                        <div class="field-group projecao-safra-item">
                            <div class="field-item">
                                <label>Ano safra</label>
                                <select>
                                    <option value="2024/2025">2024/2025</option>
                                    <option value="2025/2026">2025/2026</option>
                                </select>
                            </div>
                            <div class="field-item">
                                <label>Cultura</label>
                                <select>
                                    <option value="Soja">Soja</option>
                                    <option value="Milho">Milho</option>
                                    <option value="Trigo">Trigo</option>
                                    <option value="Canola">Canola</option>
                                    <option value="Sorgo">Sorgo</option>
                                    <option value="Outros">Outros</option>
                                </select>
                            </div>
                            <div class="field-item">
                                <label>Área plantada (ha)</label>
                                <input type="number" class="projecao-area">
                            </div>
                            <div class="field-item">
                                <label>Produtividade (sc/ha)</label>
                                <input type="number" class="projecao-produtividade">
                            </div>
                            <div class="field-item">
                                <label>Preço por saca (R$)</label>
                                <input type="text" class="valor-input projecao-preco" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Valor da produção (R$)</label>
                                <input type="text" class="valor-input projecao-valor-producao" placeholder="0,00" readonly>
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="outras-receitas" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Outras Receitas</div>
                    <div id="outras-receitas-container">
                        <div class="field-group outra-receita-item">
                            <div class="field-item">
                                <label>Descrição</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Vr. Mensal</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Vr. Anual</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="dados-financeiros" class="tab-content">
                <div class="form-section">
                    <div class="field-group">
                        <div class="field-item">
                            <label>Banco</label>
                            <select>
                                <option value="">Selecione</option>
                                <option value="TentosCap">TentosCap</option>
                                <option value="Banco do Brasil">Banco do Brasil</option>
                                <option value="Bradesco">Bradesco</option>
                                <option value="Caixa Econômica Federal">Caixa Econômica Federal</option>
                                <option value="Itaú">Itaú</option>
                                <option value="Santander">Santander</option>
                                <option value="Sicoob">Sicoob</option>
                                <option value="Sicredi">Sicredi</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Tipo de Conta</label>
                            <select>
                                <option value="corrente">Conta Corrente</option>
                                <option value="poupanca">Conta Poupança</option>
                            </select>
                        </div>
                        <div class="field-item">
                            <label>Agência</label>
                            <input type="text">
                        </div>
                        <div class="field-item">
                            <label>Conta</label>
                            <input type="text">
                        </div>
                        <div class="field-item field-small">
                            <label>Dígito</label>
                            <input type="text">
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="pecuaria" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Atividades de Pecuária</div>
                    <div id="pecuaria-container">
                        <div class="field-group pecuaria-item">
                            <div class="field-item">
                                <label>Atividade</label>
                                <select>
                                    <option value="">Selecione</option>
                                    <option value="Gado de Corte - Cria">Gado de Corte - Cria</option>
                                    <option value="Gado de Corte - Recria/Engorda">Gado de Corte - Recria/Engorda</option>
                                    <option value="Gado de Corte - Cria/Recria/Engorda">Gado de Corte - Cria/Recria/Engorda</option>
                                    <option value="Gado de Corte - Confinamento">Gado de Corte - Confinamento</option>
                                    <option value="Gado de Corte - Semi-confinamento">Gado de Corte - Semi-confinamento</option>
                                    <option value="Gado de Leite à Pasto">Gado de Leite à Pasto</option>
                                    <option value="Gado de Leite Confinado">Gado de Leite Confinado</option>
                                    <option value="Gado de Leite Semi-confinado">Gado de Leite Semi-confinado</option>
                                </select>
                            </div>
                            <div class="field-item">
                                <label>Quantidade</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Vr. Mercado</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Obs.</label>
                                <input type="text">
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="bens-moveis" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Bens Móveis em Geral</div>
                    <div id="bens-moveis-container">
                        <div class="field-group bens-moveis-item">
                            <div class="field-item">
                                <label>Ano fabricação</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Ano modelo</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Valor de mercado</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Marca</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Modelo</label>
                                <input type="text">
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="section-title">Implementos usados na atividade rural</div>
                    <div id="implementos-container">
                        <div class="field-group implemento-item">
                            <div class="field-item">
                                <label>Ano de fabricação</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Ano modelo</label>
                            <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Valor de mercado</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Marca</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Modelo</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Tipo de implemento</label>
                                <input type="text">
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="bens-imoveis" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Áreas Próprias</div>
                    <div id="areas-proprias-container">
                        <div class="field-group area-propria-item">
                            <div class="field-item">
                                <label>Proprietário</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Área total (ha)</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Valor venal</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Município</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Denominação</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>CAR</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Matrícula</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>CEP</label>
                                <input type="text" class="cep-input">
                            </div>
                            <div class="field-item">
                                <input type="file" accept=".kml" class="kml-file-input" style="display: none;">
                                <button class="kml-button" type="button">Importar KML</button>
                                <div class="kml-area-display"></div>
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="section-title">Áreas de Teceiros</div>
                    <div id="areas-arrendadas-container">
                        <div class="field-group area-arrendada-item">
                            <div class="field-item">
                                <label>Proprietário</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Área total (ha)</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Área explorada (ha)</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Fim da Vigencia.</label>
                                <input type="date">
                            </div>
                            <div class="field-item">
                                <label>Município</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Denominação</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>CAR</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Matrícula</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>CEP</label>
                                <input type="text" class="cep-input">
                            </div>
                            <div class="field-item">
                                <input type="file" accept=".kml" class="kml-file-input" style="display: none;">
                                <button class="kml-button" type="button">Importar KML</button>
                                <div class="kml-area-display"></div>
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="funcionarios" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Funcionários</div>
                    <div id="funcionarios-container">
                        <div class="field-group funcionario-item">
                            <div class="field-item">
                                <label>Qtde. funcionários fixos</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Valor média folha fixos</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Qtde. temporários</label>
                                <input type="number">
                            </div>
                            <div class="field-item">
                                <label>Valor média folha temporários</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="seguros" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Seguros</div>
                    <div id="seguros-container">
                        <div class="field-group seguro-item">
                            <div class="field-item">
                                <label>Modalidade</label>
                                <select>
                                    <option value="">Selecione</option>
                                    <option value="Lavoura">Lavoura</option>
                                    <option value="Veiculo">Veículo</option>
                                    <option value="Maquina">Máquina</option>
                                    <option value="Vida">Vida</option>
                                </select>
                            </div>
                            <div class="field-item">
                                <label>Bem Segurado</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Vr. cobertura</label>
                                <input type="text" class="valor-input" placeholder="0,00">
                            </div>
                            <div class="field-item">
                                <label>Vencimento</label>
                                <input type="date">
                            </div>
                            <button class="add-button" type="button">+ Adicionar</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="aceites" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Declaração de PEP</div>
                    <div class="legal-text">
                        Conforme estabelece a Lei 9.613/1998, alterada pela 12.683/2012 e Resolução 29/2017 do COAF, as Instituições Financeiras devem identificar as pessoas que desempenham ou tenham desempenhado, nos últimos 5 (cinco) anos, no Brasil ou em outros países, cargos, empregos ou funções públicas relevantes, assim como seus representantes, familiares e pessoas de seu relacionamento, ou seja: pais, filhos, cônjuge, companheiro(a) e enteado(a).
                    </div>
                    <div class="legal-text">
                        Para cumprimento desta determinação legal, favor nos fornecer as seguintes informações:
                    </div>
                    <div class="field-group">
                        <div class="field-item">
                            <label>Exerce ou exerceu nos últimos 5 (cinco) anos algum cargo, emprego ou função pública relevante?</label>
                            <select id="pep-select">
                                <option value="Sim">Sim</option>
                                <option value="Não" selected>Não</option>
                            </select>
                        </div>
                    </div>
                    <div id="pep-details-container" class="hidden">
                        <div class="field-group">
                            <div class="field-item">
                                <label>Cargo ou Função</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Empresa e/ou Órgão Público</label>
                                <input type="text">
                            </div>
                        </div>
                        <div class="field-group">
                            <div class="field-item">
                                <label>Data de início do exercício</label>
                                <input type="date">
                            </div>
                            <div class="field-item">
                                <label>Data do fim do exercício</label>
                                <input type="date">
                            </div>
                        </div>
                    </div>
                    <div class="field-group" style="margin-top: 15px;">
                        <div class="field-item">
                            <label>Possui relacionamento e/ou ligação com pessoa que exerce ou exerceu algum cargo, emprego, ou função pública nos últimos 5 (cinco) anos?</label>
                            <select id="pep-relacionamento-select">
                                <option value="Sim">Sim</option>
                                <option value="Não" selected>Não</option>
                            </select>
                        </div>
                    </div>
                    <div id="pep-relacionamento-details-container" class="hidden">
                        <div class="field-group">
                            <div class="field-item">
                                <label>Nome da pessoa</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Vínculo</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Cargo ou Função</label>
                                <input type="text">
                            </div>
                            <div class="field-item">
                                <label>Empresa e/ou Órgão Público</label>
                                <input type="text">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-section">
                    <div class="section-title">Autorizações</div>
                    <div class="legal-text">
                        O cliente, acima qualificado, AUTORIZA por este instrumento a Tentos S.A Crédito, Financiamento e Investimento, em atenção à Resolução nº 5.037/22 do Conselho Monetário Nacional (CMN) e as normas constantes no Manual do Crédito Rural, em caráter irrevogável e irretratável a:
                    </div>
                    <div style="margin-top: 10px;">
                        <div class="legal-item">
                            <input type="checkbox" checked>
                            <p>I. consultar os débitos e responsabilidades decorrentes de operações com características de crédito e demais informações e registros que em seu nome constem ou venham a contar do Sistema de Informações de Crédito (SCR), gerido pelo Banco Central do Brasil (BACEN), declarando estar ciente que os dados de suas respectivas operações contratadas com a Tentos S.A Crédito, Financiamento e Investimento, serão registrados no SCR e que o mesmo poderá ser consultado por outras instituições financeiras ou de qualquer forma autorizadas a consultar o referido Sistema, para fins de análise de risco de crédito, a qualquer tempo.</p>
                        </div>
                        <div class="legal-item">
                            <input type="checkbox" checked>
                            <p>II. realizar consultas em seu nome ao Cadastro de Clientes do Sistema Financeiro Nacional (CCS), gerido pelo Banco Central do Brasil (BACEN), declarando estar ciente de que os dados sobre o relacionamento com a Tentos S.A Crédito, Financiamento e Investimento poderão ser registrados no referido sistema.</p>
                        </div>
                        <div class="legal-item">
                            <input type="checkbox" checked>
                            <p>III. consultar o Cadastro Positivo, declarando estar ciente de que as informações de adimplemento das suas obrigações financeiras e de pagamentos poderão ser registradas e consultadas pelas empresas de proteção ao crédito.</p>
                        </div>
                        <div class="legal-item">
                            <input type="checkbox" checked>
                            <p>IV. consultar a plataforma de informações de Crédito Rural mantida pelo Banco Central do Brasil (BACEN), especialmente quanto ao valor do seu limite de crédito rural, e aos registros de operações de crédito rural com outras instituições financeiras.</p>
                        </div>
                        <div class="legal-item">
                            <input type="checkbox" checked>
                            <p>V. consultar bases de dados públicas e privadas, especialmente à Receita Federal, para verificação de informações cadastrais, de renda, patrimônio e de crédito, para fins de análise de risco e verificação de informações prestadas.</p>
                        </div>
                        <div class="legal-item">
                            <input type="checkbox" checked>
                            <p>VI. autoriza a coleta, armazenamento, tratamento e compartilhamento das informações e dados pessoais do seu cadastro, para as finalidades relacionadas à análise de crédito, à concessão de crédito, à manutenção e gestão do crédito concedido, e às demais finalidades previstas em lei ou nos regulamentos dos órgãos competentes.</p>
                        </div>
                        <div class="legal-item">
                            <input type="checkbox" checked>
                            <p>VII. autoriza o envio de informações e comunicações relativas às suas operações e serviços contratados, por meio de mensagens eletrônicas (SMS, e-mail), WhatsApp ou qualquer outro meio de comunicação digital.</p>
                        </div>
                    </div>
                </div>
            </div>

            <div id="declaracao" class="tab-content">
                <div class="form-section">
                    <div class="section-title">Declaração</div>
                    <div class="legal-text">
                        Eu, <span class="print-only">_________________________________</span>, inscrito no CPF sob o nº <span class="print-only">_________________________</span>, declaro que as informações acima são verdadeiras.
                    </div>
                </div>
                <div class="signature-block">
                    <div class="line"></div>
                    <div class="info-text">Assinatura</div>
                </div>
                <div class="flex-row-signature">
                    <div class="signature-item">
                        <div class="line"></div>
                        <div class="info-text">CPF</div>
                    </div>
                    <div class="signature-item">
                        <div class="line"></div>
                        <div class="info-text">RG</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const tabs = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const estadoCivilSelect = document.getElementById('estado-civil');
        const regimeCasamentoContainer = document.getElementById('regime-casamento-container');
        const conjugeInfoContainer = document.getElementById('conjuge-info-container');
        const conjugeInfoContainer2 = document.getElementById('conjuge-info-container-2');
        const conjugeInfoContainer3 = document.getElementById('conjuge-info-container-3');
        const pepSelect = document.getElementById('pep-select');
        const pepDetailsContainer = document.getElementById('pep-details-container');
        const pepRelacionamentoSelect = document.getElementById('pep-relacionamento-select');
        const pepRelacionamentoDetailsContainer = document.getElementById('pep-relacionamento-details-container');
        const nomePfInput = document.getElementById('nome-pf');
        const cpfInput = document.getElementById('cpf');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(item => item.classList.remove('active'));
                tabContents.forEach(item => item.classList.remove('active'));
                
                tab.classList.add('active');
                const target = document.querySelector(tab.dataset.tabTarget);
                target.classList.add('active');
            });
        });

        estadoCivilSelect.addEventListener('change', (event) => {
            const isCasado = event.target.value === 'Casado';
            if (isCasado) {
                regimeCasamentoContainer.classList.remove('hidden');
                conjugeInfoContainer.classList.remove('hidden');
                conjugeInfoContainer2.classList.remove('hidden');
                conjugeInfoContainer3.classList.remove('hidden');
            } else {
                regimeCasamentoContainer.classList.add('hidden');
                conjugeInfoContainer.classList.add('hidden');
                conjugeInfoContainer2.classList.add('hidden');
                conjugeInfoContainer3.classList.add('hidden');
            }
        });

        pepSelect.addEventListener('change', (event) => {
            const isPep = event.target.value === 'Sim';
            if (isPep) {
                pepDetailsContainer.classList.remove('hidden');
            } else {
                pepDetailsContainer.classList.add('hidden');
            }
        });

        pepRelacionamentoSelect.addEventListener('change', (event) => {
            const hasPepRel = event.target.value === 'Sim';
            if (hasPepRel) {
                pepRelacionamentoDetailsContainer.classList.remove('hidden');
            } else {
                pepRelacionamentoDetailsContainer.classList.add('hidden');
            }
        });

        const cepInput = document.getElementById('cep');
        const logradouroInput = document.getElementById('logradouro');
        const bairroInput = document.getElementById('bairro');
        const cidadeInput = document.getElementById('cidade');
        const ufInput = document.getElementById('uf');

        cepInput.addEventListener('blur', async (event) => {
            const cep = event.target.value.replace(/\D/g, '');
            if (cep.length === 8) {
                try {
                    const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                    const data = await response.json();
                    if (!data.erro) {
                        logradouroInput.value = data.logradouro;
                        bairroInput.value = data.bairro;
                        cidadeInput.value = data.localidade;
                        ufInput.value = data.uf;
                    } else {
                        alert('CEP não encontrado.');
                    }
                } catch (error) {
                    console.error('Erro ao buscar CEP:', error);
                    alert('Erro ao buscar CEP.');
                }
            }
        });

        // Removida a função formatValue e o listener. A formatação agora ocorre apenas no output.
        // As entradas de valor serão tratadas como números para o cálculo.

        const parseValor = (valorString) => {
            if (!valorString) return 0;
            return parseFloat(valorString.replace(/\./g, '').replace(',', '.')) || 0;
        };

        const formatarValor = (valor) => {
            if (isNaN(valor)) return '0,00';
            return valor.toLocaleString('pt-BR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        };

        const setupRendaCalculations = (containerId) => {
            const container = document.getElementById(containerId);
            container.addEventListener('input', (event) => {
                const item = event.target.closest('.renda-safra-item, .projecao-safra-item');
                if (item) {
                    const areaInput = item.querySelector('.renda-area, .projecao-area');
                    const produtividadeInput = item.querySelector('.renda-produtividade, .projecao-produtividade');
                    const precoInput = item.querySelector('.renda-preco, .projecao-preco');
                    const valorProducaoInput = item.querySelector('.renda-valor-producao, .projecao-valor-producao');

                    const area = parseFloat(areaInput.value) || 0;
                    const produtividade = parseFloat(produtividadeInput.value) || 0;
                    const preco = parseValor(precoInput.value);

                    if (area > 0 && produtividade > 0 && preco > 0) {
                        const valor = area * produtividade * preco;
                        valorProducaoInput.value = formatarValor(valor);
                    } else {
                        valorProducaoInput.value = '0,00';
                    }
                }
            });
        };

        setupRendaCalculations('renda-safra-container');
        setupRendaCalculations('projecao-safra-container');

        const receitaAgricolaInput = document.getElementById('receita-agricola');
        const demaisReceitasInput = document.getElementById('demais-receitas');
        const totalRendasInput = document.getElementById('total-rendas');

        const calcularTotalRendas = () => {
            const receitaAgricola = parseValor(receitaAgricolaInput.value);
            const demaisReceitas = parseValor(demaisReceitasInput.value);
            const totalRendas = receitaAgricola + demaisReceitas;
            totalRendasInput.value = formatarValor(totalRendas);
        };

        receitaAgricolaInput.addEventListener('input', calcularTotalRendas);
        demaisReceitasInput.addEventListener('input', calcularTotalRendas);

        document.body.addEventListener('click', (event) => {
            const button = event.target;
            
            if (button.classList.contains('add-button')) {
                const item = button.closest('.field-group');
                const newItem = item.cloneNode(true);
                
                newItem.querySelectorAll('input, select, textarea').forEach(input => {
                    if (input.type === 'checkbox') {
                        input.checked = false;
                    } else {
                        input.value = '';
                    }
                });
                
                const newButton = newItem.querySelector('.add-button');
                if (newButton) {
                    newButton.textContent = '- Remover';
                    newButton.classList.remove('add-button');
                    newButton.classList.add('remove-button');
                }
                
                const kmlDisplay = newItem.querySelector('.kml-area-display');
                if (kmlDisplay) {
                    kmlDisplay.textContent = '';
                }

                button.closest('.form-section').appendChild(newItem);
            } else if (button.classList.contains('remove-button')) {
                const itemToRemove = button.closest('.field-group');
                if (itemToRemove) {
                    itemToRemove.remove();
                }
            }
        });

        const kmlButtons = document.querySelectorAll('.kml-button');
        kmlButtons.forEach(button => {
            button.addEventListener('click', () => {
                const fileInput = button.parentElement.querySelector('.kml-file-input');
                fileInput.click();
            });
        });

        const kmlFileInputs = document.querySelectorAll('.kml-file-input');
        kmlFileInputs.forEach(input => {
            input.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const kmlText = e.target.result;
                            const parser = new DOMParser();
                            const kmlDoc = parser.parseFromString(kmlText, "text/xml");
                            const coordinatesText = kmlDoc.querySelector('coordinates').textContent;
                            
                            const coords = coordinatesText.trim().split(/\s+/).map(c => c.split(',').map(Number));
                            if (coords.length > 2) {
                                let area = 0;
                                for (let i = 0; i < coords.length - 1; i++) {
                                    area += coords[i][0] * coords[i+1][1] - coords[i+1][0] * coords[i][1];
                                }
                                area = Math.abs(area / 2);
                                
                                const areaDisplay = event.target.parentElement.querySelector('.kml-area-display');
                                areaDisplay.textContent = `Área calculada: ${area.toFixed(2)} ha`;
                                
                                const areaTotalInput = event.target.closest('.field-group').querySelector('[aria-label="Área total (ha)"]');
                                if (areaTotalInput) {
                                    areaTotalInput.value = area.toFixed(2);
                                }
                            }
                        } catch (err) {
                            console.error("Erro ao processar KML:", err);
                            const areaDisplay = event.target.parentElement.querySelector('.kml-area-display');
                            areaDisplay.textContent = 'Erro ao processar KML.';
                        }
                    };
                    reader.readAsText(file);
                }
            });
        });

        window.generatePdf = () => {
            window.print();
        };

        document.getElementById('unidade-3t').addEventListener('change', updateDeclaracaoInfo);
        document.getElementById('data-cadastro').addEventListener('change', updateDeclaracaoInfo);

        function updateDeclaracaoInfo() {
            const unidade3T = document.getElementById('unidade-3t').value;
            const dataCadastro = document.getElementById('data-cadastro').value;

            const unidadeElement = document.getElementById('assinatura-unidade-3t');
            const dataElement = document.getElementById('assinatura-data-cadastro');

            let dataFormatada = '';
            if (dataCadastro) {
                const [ano, mes, dia] = dataCadastro.split('-');
                dataFormatada = `${dia}/${mes}/${ano}`;
            }

            if (unidadeElement) unidadeElement.textContent = unidade3T ? `Unidade: ${unidade3T}` : '';
            if (dataElement) dataElement.textContent = dataFormatada ? `Data: ${dataFormatada}` : '';
        }
    });
</script> </body>
</html>